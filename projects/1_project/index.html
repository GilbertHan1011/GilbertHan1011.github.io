<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> TrajAtlas | Gilbert Han </title> <meta name="author" content="Gilbert Han"> <meta name="description" content="Trajectory Framework for Large-Scale Atlas"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gilberthan1011.github.io/projects/1_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Gilbert</span> Han </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">books </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">TrajAtlas</h1> <p class="post-description">Trajectory Framework for Large-Scale Atlas</p> </header> <article> <p>TrajAtlas was my first project, and it holds a special place in my heart. It came into my life during the hardest time, giving me the goal to walk out from the depression. Through this project, I gained a comprehensive understanding of academic research, learning how to identify a starting point, deliver presentations, and engage in academic writing. While I acknowledge that the project may not be perfect, I can confidently say it represents my best effort. I believe TrajAtlas contributes to the advancement of life sciences—perhaps a small step for humanity, but a significant leap for me personally. I am deeply grateful to everyone who supported me, especially Huan Liu, whose assistance was invaluable in bringing this paper to fruition.</p> <p>The motivation for this project stems from the observation that osteoblasts have diverse origins. This idea was excellently <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/jbmr.4410" rel="external nofollow noopener" target="_blank">reviewed</a> by Noriaki Ono, who I was fortunate to have as one of my reviewers. I soon realized that there was no systematic analysis from a single-cell RNA perspective. While there has been a significant growth in scRNA datasets from various tissues, I believe I can utilize these datasets to construct an atlas to reveal the origins of osteoblast cells.</p> <p>Then comes the Differentiation Atlas, the first atlas that focus on differentiation. The preparation process is long and difficult. I have no ideas whether datasets from different tissues can be integrate together. So I carefully collected the metadata, made lots of benchmarking, and I even pre-construct three tissue atlas seperately.</p> <div class="row"> <div class="col-sm mt-2 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/proj_trajatlas/TrajAtlas_tissue.png" sizes="95vw"></source> <img src="/assets/img/proj_trajatlas/TrajAtlas_tissue.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="three-level tissue metadata" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-2 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/proj_trajatlas/benchmark.png" sizes="95vw"></source> <img src="/assets/img/proj_trajatlas/benchmark.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Benchmarking Results" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Preparation process of Differentaiton Atlas Construction. Three-level tissue metadata (left) and Benchmarking Results (Right) </div> <p>As I delved deeper into the project, I realized that I couldn’t provide arbitrary annotations. Therefore, I utilized consensus names, marker genes, tissue location, age, and experimentally-validated cell groups to define the clusters. I have a detailed discussion on this topic <a href="https://trajatlas.readthedocs.io/en/stable/introduction/Differentiation_Atlas.html" rel="external nofollow noopener" target="_blank">here</a>.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/proj_trajatlas/tree.png" sizes="95vw"></source> <img src="/assets/img/proj_trajatlas/tree.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Annotree" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Annotation Trees </div> <p>The next step is to build a model to reflect differentiation. This is complex, as there are few studies describing multiple starting points converging to a single endpoint. I discuss this problem on this <a href="https://trajatlas.readthedocs.io/en/stable/introduction/OPCST_model.html" rel="external nofollow noopener" target="_blank">page</a>. Additionally, I spent considerable time developing a universal method to measure differentiation progression. After benchmarking various machine learning methods, I ultimately chose the LGBM Regressor for its accuracy and ability to avoid overfitting.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/proj_trajatlas/common_pseudo.png" sizes="95vw"></source> <img src="/assets/img/proj_trajatlas/common_pseudo.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="common_pseudo" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Benchmarking of common pseudotime </div> <p>Another great idea that came to me was the ability to detect differential genes along minimal units (neighbors) of datasets. This led to the development of <a href="https://trajatlas.readthedocs.io/en/stable/introduction/TrajDiff.html" rel="external nofollow noopener" target="_blank">TrajDiff</a>, a tool based on edgeR and binomial distribution to detect differential genes and differential abundance. During this process, Lamian and Condiments have came out. However, I believe TrajDiff is the best, as it can detect local differences and produce beautiful visualizations.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/proj_trajatlas/Fig4.png" sizes="95vw"></source> <img src="/assets/img/proj_trajatlas/Fig4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Trajdiff" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> TrajDiff </div> <p>And the best part is TRAVMap. I always want to visualize the trajectory as a point, to reflect the relationship between trajectories. Ultilizing pseudotime as an axis, I found the way to connected trajectories. An additional outcome is the development of an algorithm to detect pseudotime gene modules, which was described <a href="https://trajatlas.readthedocs.io/en/stable/introduction/TRAVMap.html" rel="external nofollow noopener" target="_blank">here</a>.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/proj_trajatlas/Fig12.png" sizes="95vw"></source> <img src="/assets/img/proj_trajatlas/Fig12.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Trajdiff" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> TRAVMap. Every point is a trajectory. </div> <p>I had a very hard time combining all these elements to form a cohesive paper. I rewrote the article many times. Huan Liu provided me with a lot of help, and I found an invaluable <a href="https://stevenpinker.com/publications/sense-style-thinking-persons-guide-writing-21st-century" rel="external nofollow noopener" target="_blank">book</a> written by Steven Pinker, which helped me write more clearly. After submitting to PLOS Genetics, two reviewers, Noriaki Ono and Jiadong Mao, provided plenty of critical comments that greatly improved the quality of my manuscript.</p> <p>Through this journey, I’ve come to realize that learning, creating, and expressing myself are some of the most beautiful experiences in my life. I’ve discovered that exploring the unknown is an essential part of my life’s purpose. This project is just a starting point, and I see it as a launchpad for what lies ahead. I am filled with anticipation for the future!</p> </article> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"GilbertHan1011/GilbertHan1011.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Gilbert Han. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-books",title:"books",description:"A curated list of books I&#39;ve read and recommend.",section:"Navigation",handler:()=>{window.location.href="/books/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"Some cool stuffs",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"repositories",description:"This is my github page!",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"This is my resume!",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-trajatlas-39-striking-image",title:"TrajAtlas&#39; striking image",description:"A fascinating image created by Jialin Wu",section:"Posts",handler:()=>{window.location.href="/blog/2024/trajatlas-image/"}},{id:"post-all-about-scatac-seq-39-s-quality-control",title:"All about scATAC-seq&#39;s quality control",description:"I described a new way for scATAC-seq quality control",section:"Posts",handler:()=>{window.location.href="/blog/2024/scATAC-quality-control/"}},{id:"news-start-my-postgraduate-career-in-wuhan-university",title:"Start my postgraduate career in Wuhan University!",description:"",section:"News"},{id:"news-linkset-project-started",title:"LinkSet project started!",description:"",section:"News"},{id:"news-trajatlas-get-accepted-by-plos-genetics",title:"TrajAtlas get accepted by Plos Genetics!",description:"",section:"News"},{id:"projects-trajatlas",title:"TrajAtlas",description:"Trajectory Framework for Large-Scale Atlas",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-linkset",title:"linkSet",description:"R package for handling promoter-enhancer interactions.",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%47%69%6C%62%65%72%74%48%61%6E%31%30%31%31@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=Dpzc2lUAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> <script type="module" src="https://gilberthan1011.github.io/mybookshelf/bookshelf.js"></script> </body> </html>