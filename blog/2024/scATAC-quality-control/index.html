<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> All about scATAC-seq's quality control | Gilbert Han </title> <meta name="author" content="Gilbert Han"> <meta name="description" content="I described a new way for scATAC-seq quality control"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gilberthan1011.github.io/blog/2024/scATAC-quality-control/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Gilbert</span> Han </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">books </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">All about scATAC-seq's quality control</h1> <p class="post-meta"> Created in April 21, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/bioinfo"> <i class="fa-solid fa-hashtag fa-sm"></i> bioinfo</a>   ·   <a href="/blog/category/bioinfo"> <i class="fa-solid fa-tag fa-sm"></i> bioinfo</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>One main challenge in scATAC-seq analysis is to distinguish the good cells (high quality cells), the bad cells(low quality cells), and the ugly cells (doublet cells).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713701483232.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713701483232.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <h2 id="the-bad--low-quality-cell">The bad—- low quality cell</h2> <h3 id="why-should-i-perform-quality-control">Why should I perform quality control</h3> <p>The low quality cells and the doublet cells can influence the downstream analysis, such as clustering (form a unique cluster), trajectory analysis (create artificial trajectories) and so on. <a href="https://bioconductor.org/books/3.18/OSCA.basic/quality-control.html#ref-lun2018overcoming" rel="external nofollow noopener" target="_blank">OSCA book</a> has great explaination about this issue.</p> <h3 id="what-metrics-are-used-to-distinguish-between-the-good-and-the-bad">What metrics are used to distinguish between the good and the bad</h3> <p>Different frameworks perfer different metrics to perform quality control. For example, <a href="https://www.archrproject.com/bookdown/per-cell-quality-control.html" rel="external nofollow noopener" target="_blank">ArchR</a> and <a href="https://kzhang.org/SnapATAC2/tutorials/pbmc.html" rel="external nofollow noopener" target="_blank">SnapATAC2</a> utilized TSS enrichment and number of unique fragments. And <a href="https://muon.readthedocs.io/en/latest/omics/atac.html#id1" rel="external nofollow noopener" target="_blank">Muon</a> use TSS enrichment and nucleosome signal to perform quality control. To compare what’s best strategy to preform quality control, I firstly classified the metrics to following categories.</p> <h4 id="sequencing-depth">Sequencing depth</h4> <p>Similar with scRNAseq datasets, scATAC has sequencing depth, which related with total number of fragments in peaks, unique fragment number, unique peak number, and so on. Low sequencing depth means low quailty. High sequencing depth may related with doublets, nuclei clumps, or other artefacts.</p> <h4 id="transcriptional-start-site-tss-enrichment-score">Transcriptional start site (TSS) enrichment score</h4> <p>TSS enrichment score is the ratio of fragments centered at the TSS to fragments in TSS-flanking regions. This metrics is used in nearly every scATAC framework. Extremely high TSS scores and extremely low TSS scores are both not good signs.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713770714671.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713770714671.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <h4 id="fraction-of-fragments-in-peaks-frip">Fraction of fragments in peaks (FRiP)</h4> <p>Represents the fraction of all fragments that fall within ATAC-seq peaks. This is a good metric to show signal-noise ratio.</p> <h4 id="nucleosome-banding-pattern">Nucleosome banding pattern</h4> <p>Because chromosomes are organized into units called nucleosomes, fragment size can exhibit periodic distribution correlated with nucleosome size. Fragments in high quality cells are nucleosome-free (&lt;147 bp).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713771076735.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713771076735.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <h4 id="others">Others</h4> <p>For example, duplication fraction in <a href="https://pycistopic.readthedocs.io/en/latest/tutorials.html" rel="external nofollow noopener" target="_blank">pycistopic</a>, ratio reads in genomic blacklist regions in <a href="https://stuartlab.org/signac/articles/pbmc_vignette" rel="external nofollow noopener" target="_blank">signac</a>.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713772397798.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713772397798.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <h3 id="how-to-choose-quality-control-metrics">How to choose quality control metrics?</h3> <p>A good metric typically effectively distinguishes between good and bad cells. So, we begin by exploring whether the above metrics are indicative.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713775198151.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713775198151.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>We observed that the four metrics seperate bad cells (red box) and good cells well. If we combine these metrics, the seperation are more clear.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713775982399.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713775982399.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <h3 id="how-to-filter-cells-base-on-qc-metrics">How to filter cells base on QC metrics</h3> <p>While low quailty cells can be discovered with different reasons (i.e. low sequencing depth, high nucleosome signal), we noticed that high quality cells are usually clustered together. This give us a intuation, that we can select cells base on unspervise clustering methods, like Kmeans.</p> <p>Base on this thought, I apply kmeans on QC metrics to assess wether it can select high quality cells.</p> <p>I select TSS enrichment, nucleosome signal, percent of reads in peaks, number of fragment to be the feature. After normalization, I apply Kmeans.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713785029703.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713785029703.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>As we can see, Kmeans method is excellent at select high quality cells. Low quality cells are grouped together to form low-sequencing-depth cluster, high-nuleosome-signal cluster, and low-TSS score clusters.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713784536547.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713784536547.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>I tried different number of clusters in Kmeans. As we can see, this methods is very robust, high quality cells are always cluster togehter until cluster number increase to 6.</p> <h3 id="what-about-other-qc-methods">What about other QC methods</h3> <p>I compared different QC methods provided by various framework. The results are show below.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713786089347.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713786089347.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>Not suprising, the results in different methods are similar. But what’s the best quality control methods? I used total cell number - unique cell number to roughly estimate the performance of different methods.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713787023636.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713787023636.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>As we can see, Kmeans methods has best performance in our datasets.</p> <h3 id="whats-filter-methods-of-cellrangers">What’s filter methods of cellrangers?</h3> <p>You may notice that cellranger’s quality control is very strict. While other methods leaves 18000-20000 cells, cellranger’s qc only leaves 11577 cells. You can find the filter results in <code class="language-plaintext highlighter-rouge">filtered_peak_bc_matrix.h5</code> and <code class="language-plaintext highlighter-rouge">singlecell.csv</code>. From their <a href="https://support.10xgenomics.com/single-cell-atac/software/pipelines/2.0/map/cr-atac" rel="external nofollow noopener" target="_blank">pipeline</a>, we can see it remove doublet and low quality cells with it’s own methods.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713789253939.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713789253939.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>It use <a href="https://kb.10xgenomics.com/hc/en-us/articles/360001892491-What-is-the-difference-between-the-filtered-and-raw-gene-barcode-matrix" rel="external nofollow noopener" target="_blank">cell-calling heuristic</a> to filter low sequencing depth cells. Due to its overly stringent filtering outcomes, I don’t believe that using cellranger’s filtering results from the outset is a good idea.</p> <h3 id="should-i-use-strict-qc-threshold-or-loose-qc-threshold">Should I use strict QC threshold or loose QC threshold?</h3> <p>I suggest to use loose method at first. The worst outcome with a loose QC threshold is an arificial cluster/trajectory. Usually you can find them at downstream. However, if you begin with strict QC at first, you may never know what opportunities you’ve missed in terms of discoveries.</p> <h2 id="the-ugly--doublets">The ugly —– doublets</h2> <h3 id="common-strategy-to-find-doublets">Common strategy to find doublets</h3> <p>There are two strategies to detect doublets. One approch is based on simulation, the other is based on coverage. <a href="https://www.sc-best-practices.org/chromatin_accessibility/quality_control.html#doublet-detection" rel="external nofollow noopener" target="_blank">Here</a> describe the difference between the two methods.</p> <h3 id="whats-the-best-way-to-detect-doublets">What’s the best way to detect doublets</h3> <p>As suggested by author of scDblFinder, it’s better to combine the two methods (coverage-based and simulation-based) to discover doublets. As most frameworks’ doublets detection methods are simulation-based, I compared the results run by scDblFinder, ArchR (<a href="https://github.com/statgen/demuxlet" rel="external nofollow noopener" target="_blank">demuxlet</a>), and SnapATAC2 (scrublet). The more related with amulet (coverage-based method), the results are better.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713792040000.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713792040000.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>As we can see, except ArchR showed bad performance, SnapATAC2 and scDblFinder both exhibit good performance.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-21-scATAC-quality-control/1713792200267.png" sizes="95vw"></source> <img src="/assets/img/2024-04-21-scATAC-quality-control/1713792200267.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The good, the bad, and the ugly in scATAC-seq </div> <p>Actually, results of SnapATAC2(scrublet) and scDblFinder are similar. If you perfer strict quality control, you can use scDblFinder; else, you can use SnapATAC2.</p> <h2 id="take-home-message">Take home message</h2> <ul> <li>Kmeans are good strategy to filter low quality cells.</li> <li>Better not use cellranger filtered methods.</li> <li>Do not use ArchR to detect doublets.</li> <li>Combine Amulet and scDblFinder/SnapATAC2 to detect doublets.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/trajatlas-image/">TrajAtlas' striking image</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Gilbert Han. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-books",title:"books",description:"A curated list of books I&#39;ve read and recommend.",section:"Navigation",handler:()=>{window.location.href="/books/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"Some cool stuffs",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"repositories",description:"This is my github page!",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"cv",description:"This is my resume!",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-trajatlas-39-striking-image",title:"TrajAtlas&#39; striking image",description:"A fascinating image created by Jialin Wu",section:"Posts",handler:()=>{window.location.href="/blog/2024/trajatlas-image/"}},{id:"post-all-about-scatac-seq-39-s-quality-control",title:"All about scATAC-seq&#39;s quality control",description:"I described a new way for scATAC-seq quality control",section:"Posts",handler:()=>{window.location.href="/blog/2024/scATAC-quality-control/"}},{id:"news-start-my-postgraduate-career-in-wuhan-university",title:"Start my postgraduate career in Wuhan University!",description:"",section:"News"},{id:"news-linkset-project-started",title:"LinkSet project started!",description:"",section:"News"},{id:"news-trajatlas-get-accepted-by-plos-genetics",title:"TrajAtlas get accepted by Plos Genetics",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_1/"}},{id:"projects-trajatlas",title:"TrajAtlas",description:"Trajectory Framework for Large-Scale Atlas",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-linkset",title:"linkSet",description:"R package for handling promoter-enhancer interactions.",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%47%69%6C%62%65%72%74%48%61%6E%31%30%31%31@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=Dpzc2lUAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> <script type="module" src="https://gilberthan1011.github.io/mybookshelf/bookshelf.js"></script> </body> </html>